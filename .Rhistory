) %>%
select(job) %>%
table()
out2 %>%
mutate(job=case_when(
str_detect(`Job Title`, 'Profess') ~"Professor",
str_detect(`Job Title`, 'Canada Research Chair') ~"Professor",
str_detect(`Job Title`, 'Lecturer') ~"Professor",
str_detect(`Job Title`, "Librar") ~"Librarian"
TRUE ~ `Job Title`
out2 %>%
mutate(job=case_when(
str_detect(`Job Title`, 'Profess') ~"Professor",
str_detect(`Job Title`, 'Canada Research Chair') ~"Professor",
str_detect(`Job Title`, 'Lecturer') ~"Professor",
str_detect(`Job Title`, "Librar") ~"Librarian",
TRUE ~ `Job Title`
)
) %>%
group_by(`Job Title`) %>%
summarize(n=n())
out2 %>%
mutate(job=case_when(
str_detect(`Job Title`, 'Profess') ~"Professor",
str_detect(`Job Title`, 'Canada Research Chair') ~"Professor",
str_detect(`Job Title`, 'Lecturer') ~"Professor",
str_detect(`Job Title`, "Librar") ~"Librarian",
TRUE ~ `Job Title`
)
) %>%
group_by(`Job Title`) %>%
summarize(n=n()) %>%
arrange(desc(n))
out2 %>%
mutate(job=case_when(
str_detect(`Job Title`, 'Profess') ~"Professor",
str_detect(`Job Title`, 'Canada Research Chair') ~"Professor",
str_detect(`Job Title`, 'Lecturer') ~"Professor",
str_detect(`Job Title`, "Librar") ~"Librarian",
TRUE ~ `Job Title`
)
) %>%
filter(Sector=="Universities") %>%
group_by(`Job Title`) %>%
summarize(n=n()) %>%
arrange(desc(n))
out2 %>%
mutate(job=case_when(
str_detect(`Job Title`, 'Profess') ~"Professor",
str_detect(`Job Title`, 'Canada Research Chair') ~"Professor",
str_detect(`Job Title`, 'Lecturer') ~"Professor",
str_detect(`Job Title`, "Librar") ~"Librarian",
TRUE ~ `Job Title`
)
) %>%
filter(Sector=="Universities") %>%
group_by(`Job Title`) %>%
summarize(n=n()) %>%
arrange(desc(n)) %>%
top_n(50)
out2 %>%
mutate(job=case_when(
str_detect(`Job Title`, 'Profess') ~"Professor",
str_detect(`Job Title`, 'Canada Research Chair') ~"Professor",
str_detect(`Job Title`, 'Lecturer') ~"Professor",
str_detect(`Job Title`, "Librar") ~"Librarian",
TRUE ~ `Job Title`
)
) %>%
filter(Sector=="Universities") %>%
group_by(job) %>%
summarize(n=n()) %>%
arrange(desc(n)) %>%
top_n(50)
out2 %>%
mutate(job=case_when(
str_detect(`Job Title`, 'Profess') ~"Professor",
str_detect(`Job Title`, 'Canada Research Chair') ~"Professor",
str_detect(`Job Title`, 'Lecturer') ~"Professor",
str_detect(`Job Title`, 'Faculty') ~"Professor",
str_detect(`Job Title`, "Librar") ~"Librarian",
TRUE ~ `Job Title`
)
) %>%
filter(Sector=="Universities") %>%
group_by(job) %>%
summarize(n=n()) %>%
arrange(desc(n)) %>%
top_n(50)
out2 %>%
mutate(job=case_when(
str_detect(`Job Title`, 'Profess') ~"Professor",
str_detect(`Job Title`, 'Canada Research Chair') ~"Professor",
str_detect(`Job Title`, 'Lecturer') ~"Professor",
str_detect(`Job Title`, 'Faculty') ~"Professor",
str_detect(`Job Title`, "Librar") ~"Librarian",
str_detect(`Job Title`, 'Prof.') ~"Professor",
TRUE ~ `Job Title`
)
) %>%
filter(Sector=="Universities") %>%
group_by(job) %>%
summarize(n=n()) %>%
arrange(desc(n)) %>%
top_n(50)
out2 %>%
mutate(job=case_when(
str_detect(`Job Title`, 'Profess') ~"Academic",
str_detect(`Job Title`, 'Canada Research Chair') ~"Academic",
str_detect(`Job Title`, 'Lecturer') ~"Academic",
str_detect(`Job Title`, 'Faculty') ~"Academic",
str_detect(`Job Title`, "Librar") ~"Librarian",
str_detect(`Job Title`, 'Prof.') ~"Academic",
str_detect(`Job Title`, 'Physician') ~"Academic",
TRUE ~ `Job Title`
)
) %>%
filter(Sector=="Universities") %>%
group_by(job) %>%
summarize(n=n()) %>%
arrange(desc(n)) %>%
top_n(50)
out2 %>%
mutate(job=case_when(
str_detect(`Job Title`, 'Profess') ~"Academic",
str_detect(`Job Title`, 'Canada Research Chair') ~"Academic",
str_detect(`Job Title`, 'Lecturer') ~"Academic",
str_detect(`Job Title`, 'Faculty') ~"Academic",
str_detect(`Job Title`, "Librar") ~"Librarian",
str_detect(`Job Title`, 'Prof.') ~"Academic",
str_detect(`Job Title`, 'Physician') ~"Academic",
str_detect(`Job Title`, 'Chair') ~"Professor",
str_detect(`Job Title`, 'Dean') ~"Professor",
TRUE ~ `Job Title`
)
) %>%
filter(Sector=="Universities") %>%
group_by(job) %>%
summarize(n=n()) %>%
arrange(desc(n)) %>%
top_n(50)
out2 %>%
mutate(job=case_when(
str_detect(`Job Title`, 'Profess') ~"Academic",
str_detect(`Job Title`, 'Canada Research Chair') ~"Academic",
str_detect(`Job Title`, 'Lecturer') ~"Academic",
str_detect(`Job Title`, 'Faculty') ~"Academic",
str_detect(`Job Title`, "Librar") ~"Librarian",
str_detect(`Job Title`, 'Prof.') ~"Academic",
str_detect(`Job Title`, 'Physician') ~"Academic",
str_detect(`Job Title`, 'Chair') ~"Professor",
str_detect(`Job Title`, 'Dean') ~"Professor",
TRUE ~ `Job Title`
)
) %>%
filter(Sector=="Universities") %>%
group_by(job) %>%
summarize(n=n()) %>%
arrange(desc(n)) %>%
top_n(100)
out2 %>%
mutate(job=case_when(
str_detect(`Job Title`, 'Professor') ~"Academic",
str_detect(`Job Title`, 'Canada Research Chair') ~"Academic",
str_detect(`Job Title`, 'Lecturer') ~"Academic",
str_detect(`Job Title`, 'Faculty') ~"Academic",
str_detect(`Job Title`, "Librar") ~"Academic",
str_detect(`Job Title`, 'Prof.') ~"Academic",
str_detect(`Job Title`, 'Physician') ~"Academic",
str_detect(`Job Title`, 'Chair') ~"Professor",
str_detect(`Job Title`, 'Dean') ~"Professor",
TRUE ~ `Job Title`
)
) %>%
filter(Sector=="Universities") %>%
group_by(job) %>%
summarize(n=n()) %>%
arrange(desc(n)) %>%
top_n(100)
?str_detect
fruit <- c("apple", "banana", "pear", "pinapple")
str_detect(fruit, "a")
out2 %>%
mutate(job=case_when(
str_detect(`Job Title`, 'Professor') ~"Academic",
str_detect(`Job Title`, 'Canada Research Chair') ~"Academic",
str_detect(`Job Title`, 'Lecturer') ~"Academic",
str_detect(`Job Title`, 'Faculty') ~"Academic",
str_detect(`Job Title`, "Librar") ~"Academic",
str_detect(`Job Title`, 'Prof.') ~"Academic",
str_detect(`Job Title`, 'Physician') ~"Academic",
str_detect(`Job Title`, 'Chair') ~"Academic",
str_detect(`Job Title`, 'Dean') ~"Academic",
str_detect(`Job Title`, 'Principal') ~"Academic",
str_detect(`Job Title`, 'Research Associate') ~"Academic",
TRUE ~ `Job Title`
)
) %>%
filter(Sector=="Universities") %>%
group_by(job) %>%
summarize(n=n()) %>%
arrange(desc(n)) %>%
top_n(100)
out2 %>%
mutate(job=case_when(
str_detect(`Job Title`, 'Professor') ~"Academic",
str_detect(`Job Title`, 'Canada Research Chair') ~"Academic",
str_detect(`Job Title`, 'Lecturer') ~"Academic",
str_detect(`Job Title`, 'Faculty') ~"Academic",
str_detect(`Job Title`, "Librar") ~"Academic",
str_detect(`Job Title`, 'Prof.') ~"Academic",
str_detect(`Job Title`, 'Physician') ~"Academic",
str_detect(`Job Title`, 'Chair') ~"Academic",
str_detect(`Job Title`, 'Dean') ~"Academic",
str_detect(`Job Title`, 'Principal') ~"Academic",
str_detect(`Job Title`, 'Research Associate') ~"Academic",
str_detect(`Job Title`, 'Clinician')~ "Academic",
TRUE ~ `Job Title`
)
) %>%
filter(Sector=="Universities") %>%
group_by(job) %>%
summarize(n=n()) %>%
arrange(desc(n)) %>%
top_n(100)
out2 %>%
mutate(job=case_when(
str_detect(`Job Title`, 'Professor') ~"Academic",
str_detect(`Job Title`, 'Canada Research Chair') ~"Academic",
str_detect(`Job Title`, 'Lecturer') ~"Academic",
str_detect(`Job Title`, 'Faculty') ~"Academic",
str_detect(`Job Title`, "Librar") ~"Academic",
str_detect(`Job Title`, 'Prof.') ~"Academic",
str_detect(`Job Title`, 'Physician') ~"Academic",
str_detect(`Job Title`, 'Chair') ~"Academic",
str_detect(`Job Title`, 'Dean') ~"Academic",
str_detect(`Job Title`, 'Principal') ~"Academic",
str_detect(`Job Title`, 'Research Associate') ~"Academic",
str_detect(`Job Title`, 'Clinician')~ "Academic",
TRUE ~ `Job Title`
)
) %>%
filter(Sector=="Universities") %>%
group_by(job) %>%
summarize(n=n()) %>%
arrange(desc(n)) %>%
top_n(100)
out2 %>%
mutate(job=case_when(
str_detect(`Job Title`, 'Professor') ~"Academic",
str_detect(`Job Title`, 'Canada Research Chair') ~"Academic",
str_detect(`Job Title`, 'Lecturer') ~"Academic",
str_detect(`Job Title`, 'Faculty') ~"Academic",
str_detect(`Job Title`, "Librar") ~"Academic",
str_detect(`Job Title`, 'Prof.') ~"Academic",
str_detect(`Job Title`, 'Physician') ~"Academic",
str_detect(`Job Title`, 'Chair') ~"Academic",
str_detect(`Job Title`, 'Dean') ~"Academic",
str_detect(`Job Title`, 'Principal') ~"Academic",
str_detect(`Job Title`, 'Research Associate') ~"Academic",
str_detect(`Job Title`, 'Clinician')~ "Academic",
TRUE ~ `Job Title`
)
) %>%
filter(Sector=="Universities") %>%
group_by(job) %>%
summarize(n=n()) %>%
arrange(desc(n))
out2 %>%
mutate(job=case_when(
str_detect(`Job Title`, 'Professor') ~"Academic",
str_detect(`Job Title`, 'Canada Research Chair') ~"Academic",
str_detect(`Job Title`, 'Lecturer') ~"Academic",
str_detect(`Job Title`, 'Faculty') ~"Academic",
str_detect(`Job Title`, "Librar") ~"Academic",
str_detect(`Job Title`, 'Prof.') ~"Academic",
str_detect(`Job Title`, 'Physician') ~"Academic",
str_detect(`Job Title`, 'Chair') ~"Academic",
str_detect(`Job Title`, 'Dean') ~"Academic",
str_detect(`Job Title`, 'Principal') ~"Academic",
str_detect(`Job Title`, 'Research Associate') ~"Academic",
str_detect(`Job Title`, 'Clinician')~ "Academic",
str_detect(`Job Title`, 'Department Head')~ "Academic",
TRUE ~ `Job Title`
)
) %>%
filter(Sector=="Universities") %>%
group_by(job) %>%
summarize(n=n()) %>%
arrange(desc(n))
out2 %>%
mutate(job=case_when(
str_detect(`Job Title`, 'Professor') ~"Academic",
str_detect(`Job Title`, 'Canada Research Chair') ~"Academic",
str_detect(`Job Title`, 'Lecturer') ~"Academic",
str_detect(`Job Title`, 'Faculty') ~"Academic",
str_detect(`Job Title`, "Librar") ~"Academic",
str_detect(`Job Title`, 'Prof.') ~"Academic",
str_detect(`Job Title`, 'Physician') ~"Academic",
str_detect(`Job Title`, 'Chair') ~"Academic",
str_detect(`Job Title`, 'Dean') ~"Academic",
str_detect(`Job Title`, 'Principal') ~"Academic",
str_detect(`Job Title`, 'Research Associate') ~"Academic",
str_detect(`Job Title`, 'Clinician')~ "Academic",
str_detect(`Job Title`, 'Department Head')~ "Academic",
str_detect(`Job Title`, 'Research Director')~ "Academic",
str_detect(`Job Title`, 'Research Manager')~ "Academic",
str_detect(`Job Title`, 'Queen\'s National Scholar')~ "Academic",
TRUE ~ `Job Title`
)
) %>%
filter(Sector=="Universities") %>%
group_by(job) %>%
summarize(n=n()) %>%
arrange(desc(n))
out3 %>%
filter(Sector=="Universities")
out2 %>%
mutate(job=case_when(
str_detect(`Job Title`, 'Professor') ~"Academic",
str_detect(`Job Title`, 'Canada Research Chair') ~"Academic",
str_detect(`Job Title`, 'Lecturer') ~"Academic",
str_detect(`Job Title`, 'Faculty') ~"Academic",
str_detect(`Job Title`, "Librar") ~"Academic",
str_detect(`Job Title`, 'Prof.') ~"Academic",
str_detect(`Job Title`, 'Physician') ~"Academic",
str_detect(`Job Title`, 'Chair') ~"Academic",
str_detect(`Job Title`, 'Dean') ~"Academic",
str_detect(`Job Title`, 'Principal') ~"Academic",
str_detect(`Job Title`, 'Research Associate') ~"Academic",
str_detect(`Job Title`, 'Clinician')~ "Academic",
str_detect(`Job Title`, 'Department Head')~ "Academic",
str_detect(`Job Title`, 'Research Director')~ "Academic",
str_detect(`Job Title`, 'Research Manager')~ "Academic",
str_detect(`Job Title`, 'Queen\'s National Scholar')~ "Academic",
str_detect(`Job Title`, 'Molecular Biologist')~ "Academic",
str_detect(`Job Title`, 'Senior Researcher')~ "Academic",
str_detect(`Job Title`, 'Psychologist')~ "Academic",
str_detect(`Job Title`, 'Contract Academic Staff')~ "Academic",
str_detect(`Job Title`, 'Clinical Research Coordinator')~ "Academic",
str_detect(`Job Title`, 'Manager, Analytical Biologyt')~ "Academic",
str_detect(`Job Title`, 'Director, Sudbury Neutrino')~ "Academic",
str_detect(`Job Title`, 'Director Wilfrid Laurier Press')~ "Academic",
str_detect(`Job Title`, 'Tutor')~ "Academic",
TRUE ~ `Job Title`
)
) %>%
filter(Sector=="Universities") ->out3
library(tidyverse)
?case_when
out3 %>%
ggplot(., aes(x=Year, fill=job))+geom_bar()
library(knitr)
opts_chunk$set(results='markup', warning=F, message=F, echo=F)
years<-seq(1996,2009, by=1)
urls<-paste0('https://files.ontario.ca/en-', years, '-pssd.csv')
#we need to change 2012
urls[15]<-'https://files.ontario.ca/2010.csv'
urls[16]<-'https://files.ontario.ca/2011.csv'
urls[17]<-'https://files.ontario.ca/pssd-en-2012-fixed_0.csv'
urls[18]<-'https://files.ontario.ca/pssd-en-2013.csv'
urls[19]<-'https://files.ontario.ca/2014-pssd-full-compendium-utf8-en.csv'
urls[20]<-'https://files.ontario.ca/pssd/en-2015-pssd-compendium-with-addendum-20161219.csv'
urls[21]<-'https://files.ontario.ca/en-2016-pssd-compendium-20171128-utf8.csv'
urls[22]<-'https://files.ontario.ca/en-2018-pssd-compendium.csv'
urls[23]<-'https://files.ontario.ca/en-2018-pssd-compendium-20191223.csv'
library(tidyverse)
library(purrr)
urls %>%
map(., read_csv)-> out
library(tidyverse)
library(stringr)
library(magrittr)
library(purrr)
out %>%
map(., extract, c(1:8)) %>%
map(., rename, `Last name`=2,
`Job Title`=7,
`Year`=8) %>%
map_df(., mutate, `Salary Paid`=str_replace(`Salary Paid`, '\\$', ''), `Taxable Benefits`=str_replace(`Taxable Benefits`, '\\$', '')) %>%
mutate(., Salary=str_replace(`Salary Paid`, "\\,", ""),
Benefits=str_replace(`Taxable Benefits`, "\\,", "")) %>%
mutate(., Salary=as.numeric(Salary), Benefits=as.numeric(Benefits),
Total=Salary+Benefits) ->out2
out2 %>%
mutate(job=case_when(
str_detect(`Job Title`, 'Professor') ~"Academic",
str_detect(`Job Title`, 'Canada Research Chair') ~"Academic",
str_detect(`Job Title`, 'Lecturer') ~"Academic",
str_detect(`Job Title`, 'Faculty') ~"Academic",
str_detect(`Job Title`, "Librar") ~"Academic",
str_detect(`Job Title`, 'Prof.') ~"Academic",
str_detect(`Job Title`, 'Physician') ~NA_character_,
str_detect(`Job Title`, 'Chair') ~"Academic",
str_detect(`Job Title`, 'Dean') ~"Academic",
str_detect(`Job Title`, 'Principal') ~"Academic",
str_detect(`Job Title`, 'Research Associate') ~"Academic",
str_detect(`Job Title`, 'Clinician')~ NA_character_,
str_detect(`Job Title`, 'Department Head')~ "Academic",
str_detect(`Job Title`, 'Research Director')~ "Academic",
str_detect(`Job Title`, 'Research Manager')~ "Academic",
str_detect(`Job Title`, 'Queen\'s National Scholar')~ "Academic",
str_detect(`Job Title`, 'Molecular Biologist')~ "Academic",
str_detect(`Job Title`, 'Senior Researcher')~ "Academic",
str_detect(`Job Title`, 'Psychologist')~ "Academic",
str_detect(`Job Title`, 'Contract Academic Staff')~ "Academic",
str_detect(`Job Title`, 'Clinical Research Coordinator')~ NA_character_,
str_detect(`Job Title`, 'Manager, Analytical Biology')~ "Academic",
str_detect(`Job Title`, 'Director, Sudbury Neutrino')~ "Academic",
str_detect(`Job Title`, 'Director Wilfrid Laurier Press')~ "Academic",
str_detect(`Job Title`, 'Tutor')~ "Academic",
TRUE ~ "Non-Academic"
)
) %>%
filter(Sector=="Universities") ->out3
# group_by(job) %>%
#  summarize(n=n()) %>%
#  arrange(desc(n))
theme_set(theme_bw())
out3 %>%
ggplot(., aes(x=Year, fill=job))+geom_bar(position="dodge")
out3 %>%
filter(is.na(job)==F) %>%
group_by(Year, job) %>%
summarize(n=n(), average=mean(Total)) %>%
ggplot(., aes(x=Year, col=job, y=average))+geom_point()
table(out3$Year)
out3 %>%
filter(is.na(job)==F) %>%
group_by(Year, job) %>%
summarize(n=n(), average=mean(Total))
out3 %>%
filter(is.na(job)==F) %>%
group_by(Year, job) %>%
summarize(n=n(), average=mean(Total)) %>%
ggplot(., aes(x=Year, col=job, y=average))+geom_point()
out3 %>%
group_by(Year, job) %>%
summarize(n=n(), average=mean(Total))
View(out2)
out[[23]]
out[[20]]
out3 %>%
filter(Year=="2015")
out3 %>%
filter(Year=="2016")
out3 %>%
filter(Year=="2015")
out3 %>%
ggplot(., aes(x=Year, fill=job))+geom_bar(position="dodge")
?sum
Total=sum(c(Salary, Benefits, na.rm=T)) ->out2
Total=sum(c('Salary', 'Benefits', na.rm=T)) ->out2
out %>%
map(., extract, c(1:8)) %>%
map(., rename, `Last name`=2,
`Job Title`=7,
`Year`=8) %>%
map_df(., mutate, `Salary Paid`=str_replace(`Salary Paid`, '\\$', ''), `Taxable Benefits`=str_replace(`Taxable Benefits`, '\\$', '')) %>%
mutate(., Salary=str_replace(`Salary Paid`, "\\,", ""),
Benefits=str_replace(`Taxable Benefits`, "\\,", "")) %>%
mutate(., Salary=as.numeric(Salary), Benefits=as.numeric(Benefits),
Total=sum(Salary,Benefits, na.rm=T)) ->out2
out %>%
map(., extract, c(1:8)) %>%
map(., rename, `Last name`=2,
`Job Title`=7,
`Year`=8) %>%
map_df(., mutate, `Salary Paid`=str_replace(`Salary Paid`, '\\$', ''), `Taxable Benefits`=str_replace(`Taxable Benefits`, '\\$', '')) %>%
mutate(., Salary=str_replace(`Salary Paid`, "\\,", ""),
Benefits=str_replace(`Taxable Benefits`, "\\,", "")) %>%
mutate(., Salary=as.numeric(Salary), Benefits=as.numeric(Benefits),
Total=sum(Salary,Benefits, na.rm=T)) ->out2
out2 %>%
mutate(job=case_when(
str_detect(`Job Title`, 'Professor') ~"Academic",
str_detect(`Job Title`, 'Canada Research Chair') ~"Academic",
str_detect(`Job Title`, 'Lecturer') ~"Academic",
str_detect(`Job Title`, 'Faculty') ~"Academic",
str_detect(`Job Title`, "Librar") ~"Academic",
str_detect(`Job Title`, 'Prof.') ~"Academic",
str_detect(`Job Title`, 'Physician') ~NA_character_,
str_detect(`Job Title`, 'Chair') ~"Academic",
str_detect(`Job Title`, 'Dean') ~"Academic",
str_detect(`Job Title`, 'Principal') ~"Academic",
str_detect(`Job Title`, 'Research Associate') ~"Academic",
str_detect(`Job Title`, 'Clinician')~ NA_character_,
str_detect(`Job Title`, 'Department Head')~ "Academic",
str_detect(`Job Title`, 'Research Director')~ "Academic",
str_detect(`Job Title`, 'Research Manager')~ "Academic",
str_detect(`Job Title`, 'Queen\'s National Scholar')~ "Academic",
str_detect(`Job Title`, 'Molecular Biologist')~ "Academic",
str_detect(`Job Title`, 'Senior Researcher')~ "Academic",
str_detect(`Job Title`, 'Psychologist')~ "Academic",
str_detect(`Job Title`, 'Contract Academic Staff')~ "Academic",
str_detect(`Job Title`, 'Clinical Research Coordinator')~ NA_character_,
str_detect(`Job Title`, 'Manager, Analytical Biology')~ "Academic",
str_detect(`Job Title`, 'Director, Sudbury Neutrino')~ "Academic",
str_detect(`Job Title`, 'Director Wilfrid Laurier Press')~ "Academic",
str_detect(`Job Title`, 'Tutor')~ "Academic",
TRUE ~ "Non-Academic"
)
) %>%
filter(Sector=="Universities") ->out3
library(blogdown)
hugo_server()
?hugo_server
hugo_serve
hugo_serve()
hugo_server()
hugo_server(host="127.0.0.1", port="1313")
serve_site()
